/*
 * Poshy Tip jQuery plugin v1.2
 * http://vadikom.com/tools/poshy-tip-jquery-plugin-for-stylish-tooltips/
 * Copyright 2010-2013, Vasil Dinkov, http://vadikom.com/
 */(function(b){var l=[],q=/^url\(["']?([^"'\)]*)["']?\);?$/i,r=/\.png$/i,p=!!window.createPopup&&"undefined"==document.documentElement.currentStyle.minWidth;b(window).resize(function(){b.each(l,function(){this.refresh(!0)})});b.Poshytip=function(a,f){this.$elm=b(a);this.opts=b.extend({},b.fn.poshytip.defaults,f);this.$tip=b(['\x3cdiv class\x3d"',this.opts.className,'"\x3e\x3cdiv class\x3d"tip-inner tip-bg-image"\x3e\x3c/div\x3e\x3cdiv class\x3d"tip-arrow tip-arrow-top tip-arrow-right tip-arrow-bottom tip-arrow-left"\x3e\x3c/div\x3e\x3c/div\x3e'].join("")).appendTo(document.body);this.$arrow=this.$tip.find("div.tip-arrow");this.$inner=this.$tip.find("div.tip-inner");this.disabled=!1;this.content=null;this.init()};b.Poshytip.prototype={init:function(){l.push(this);var a=this.$elm.attr("title");this.$elm.data("title.poshytip",void 0!==a?a:null).data("poshytip",this);if("none"!=this.opts.showOn)switch(this.$elm.bind({"mouseenter.poshytip":b.proxy(this.mouseenter,this),"mouseleave.poshytip":b.proxy(this.mouseleave,this)}),this.opts.showOn){case "hover":"cursor"==this.opts.alignTo&&this.$elm.bind("mousemove.poshytip",b.proxy(this.mousemove,this));this.opts.allowTipHover&&this.$tip.hover(b.proxy(this.clearTimeouts,this),b.proxy(this.mouseleave,this));break;case "focus":this.$elm.bind({"focus.poshytip":b.proxy(this.showDelayed,this),"blur.poshytip":b.proxy(this.hideDelayed,this)})}null!=this.opts.bgColor&&this.$tip.css("background-color",this.opts.bgColor)},mouseenter:function(a){if(this.disabled)return!0;this.$elm.attr("title","");if("focus"==this.opts.showOn)return!0;this.showDelayed()},mouseleave:function(a){if(this.disabled||this.asyncAnimating&&(this.$tip[0]===a.relatedTarget||jQuery.contains(this.$tip[0],a.relatedTarget)))return!0;this.$tip.data("active")||(a=this.$elm.data("title.poshytip"),null!==a&&this.$elm.attr("title",a));if("focus"==this.opts.showOn)return!0;this.hideDelayed()},mousemove:function(a){if(this.disabled)return!0;this.eventX=a.pageX;this.eventY=a.pageY;this.opts.followCursor&&this.$tip.data("active")&&(this.calcPos(),this.$tip.css({left:this.pos.l,top:this.pos.t}),this.pos.arrow&&(this.$arrow[0].className="tip-arrow tip-arrow-"+this.pos.arrow))},show:function(){this.disabled||this.$tip.data("active")||(this.reset(),this.update(),this.content&&(this.display(),this.opts.timeOnScreen&&this.hideDelayed(this.opts.timeOnScreen)))},showDelayed:function(a){this.clearTimeouts();this.showTimeout=setTimeout(b.proxy(this.show,this),"number"==typeof a?a:this.opts.showTimeout)},hide:function(){!this.disabled&&this.$tip.data("active")&&this.display(!0)},hideDelayed:function(a){this.clearTimeouts();this.hideTimeout=setTimeout(b.proxy(this.hide,this),"number"==typeof a?a:this.opts.hideTimeout)},reset:function(){this.$tip.queue([]).detach().css("visibility","hidden").data("active",!1);this.$inner.find("*").poshytip("hide");this.opts.fade&&this.$tip.css("opacity",this.opacity);this.$arrow[0].className="tip-arrow tip-arrow-top tip-arrow-right tip-arrow-bottom tip-arrow-left";this.asyncAnimating=!1},update:function(a,b){if(!this.disabled){var e=void 0!==a;if(e){if(b||(this.opts.content=a),!this.$tip.data("active"))return}else a=this.opts.content;var c=this,d="function"==typeof a?a.call(this.$elm[0],function(a){c.update(a)}):"[title]"==a?this.$elm.data("title.poshytip"):a;this.content!==d&&(this.$inner.empty().append(d),this.content=d);this.refresh(e)}},refresh:function(a){if(!this.disabled){if(a){if(!this.$tip.data("active"))return;var f={left:this.$tip.css("left"),top:this.$tip.css("top")}}this.$tip.css({left:0,top:0}).appendTo(document.body);void 0===this.opacity&&(this.opacity=this.$tip.css("opacity"));var e=this.$tip.css("background-image").match(q),c=this.$arrow.css("background-image").match(q);if(e){var d=r.test(e[1]);p&&d?(this.$tip.css("background-image","none"),this.$inner.css({margin:0,border:0,padding:0}),e=d=!1):this.$tip.prepend('\x3ctable class\x3d"tip-table" border\x3d"0" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\x3ctr\x3e\x3ctd class\x3d"tip-top tip-bg-image" colspan\x3d"2"\x3e\x3cspan\x3e\x3c/span\x3e\x3c/td\x3e\x3ctd class\x3d"tip-right tip-bg-image" rowspan\x3d"2"\x3e\x3cspan\x3e\x3c/span\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd class\x3d"tip-left tip-bg-image" rowspan\x3d"2"\x3e\x3cspan\x3e\x3c/span\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd class\x3d"tip-bottom tip-bg-image" colspan\x3d"2"\x3e\x3cspan\x3e\x3c/span\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e').css({border:0,padding:0,"background-image":"none","background-color":"transparent"}).find(".tip-bg-image").css("background-image",'url("'+e[1]+'")').end().find("td").eq(3).append(this.$inner);d&&!b.support.opacity&&(this.opts.fade=!1)}c&&!b.support.opacity&&(p&&r.test(c[1])&&(c=!1,this.$arrow.css("background-image","none")),this.opts.fade=!1);e=this.$tip.find("\x3e table.tip-table");if(p){this.$tip[0].style.width="";e.width("auto").find("td").eq(3).width("auto");var d=this.$tip.width(),g=parseInt(this.$tip.css("min-width")),h=parseInt(this.$tip.css("max-width"));!isNaN(g)&&d<g?d=g:!isNaN(h)&&d>h&&(d=h);this.$tip.add(e).width(d).eq(0).find("td").eq(3).width("100%")}else e[0]&&e.width("auto").find("td").eq(3).width("auto").end().end().width(document.defaultView&&document.defaultView.getComputedStyle&&parseFloat(document.defaultView.getComputedStyle(this.$tip[0],null).width)||this.$tip.width()).find("td").eq(3).width("100%");this.tipOuterW=this.$tip.outerWidth();this.tipOuterH=this.$tip.outerHeight();this.calcPos();c&&this.pos.arrow&&(this.$arrow[0].className="tip-arrow tip-arrow-"+this.pos.arrow,this.$arrow.css("visibility","inherit"));if(a&&this.opts.refreshAniDuration){this.asyncAnimating=!0;var k=this;this.$tip.css(f).animate({left:this.pos.l,top:this.pos.t},this.opts.refreshAniDuration,function(){k.asyncAnimating=!1})}else this.$tip.css({left:this.pos.l,top:this.pos.t})}},display:function(a){var f=this.$tip.data("active");if(!(f&&!a||!f&&a)){this.$tip.stop();if((this.opts.slide&&this.pos.arrow||this.opts.fade)&&(a&&this.opts.hideAniDuration||!a&&this.opts.showAniDuration)){var e={},c={};if(this.opts.slide&&this.pos.arrow){var d,g;"bottom"==this.pos.arrow||"top"==this.pos.arrow?(d="top",g="bottom"):(d="left",g="right");var h=parseInt(this.$tip.css(d));e[d]=h+(a?0:this.pos.arrow==g?-this.opts.slideOffset:this.opts.slideOffset);c[d]=h+(a?this.pos.arrow==g?this.opts.slideOffset:-this.opts.slideOffset:0)+"px"}this.opts.fade&&(e.opacity=a?this.$tip.css("opacity"):0,c.opacity=a?0:this.opacity);this.$tip.css(e).animate(c,this.opts[a?"hideAniDuration":"showAniDuration"])}a?this.$tip.queue(b.proxy(this.reset,this)):this.$tip.css("visibility","inherit");f&&(a=this.$elm.data("title.poshytip"),null!==a&&this.$elm.attr("title",a));this.$tip.data("active",!f)}},disable:function(){this.reset();this.disabled=!0},enable:function(){this.disabled=!1},destroy:function(){this.reset();this.$tip.remove();delete this.$tip;this.content=null;this.$elm.unbind(".poshytip").removeData("title.poshytip").removeData("poshytip");l.splice(b.inArray(this,l),1)},clearTimeouts:function(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=0);this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=0)},calcPos:function(){var a={l:0,t:0,arrow:""},f=b(window),e=f.scrollLeft(),c=f.scrollTop(),d=f.width(),f=f.height(),g,h,k,n,l,m;"cursor"==this.opts.alignTo?(g=h=k=this.eventX,n=l=m=this.eventY):(h=this.$elm.offset(),g=h.left,n=h.top,k=this.$elm.outerWidth(),m=this.$elm.outerHeight(),g+="inner-right"!=this.opts.alignX?0:k,h=g+Math.floor(k/2),k=g+("inner-left"!=this.opts.alignX?k:0),n+="inner-bottom"!=this.opts.alignY?0:m,l=n+Math.floor(m/2),m=n+("inner-top"!=this.opts.alignY?m:0));switch(this.opts.alignX){case "right":case "inner-left":a.l=k+this.opts.offsetX;this.opts.keepInViewport&&a.l+this.tipOuterW>e+d&&(a.l=e+d-this.tipOuterW);if("right"==this.opts.alignX||"center"==this.opts.alignY)a.arrow="left";break;case "center":a.l=h-Math.floor(this.tipOuterW/2);this.opts.keepInViewport&&(a.l+this.tipOuterW>e+d?a.l=e+d-this.tipOuterW:a.l<e&&(a.l=e));break;default:if(a.l=g-this.tipOuterW-this.opts.offsetX,this.opts.keepInViewport&&a.l<e&&(a.l=e),"left"==this.opts.alignX||"center"==this.opts.alignY)a.arrow="right"}switch(this.opts.alignY){case "bottom":case "inner-top":a.t=m+this.opts.offsetY;a.arrow&&"cursor"!=this.opts.alignTo||(a.arrow="top");this.opts.keepInViewport&&a.t+this.tipOuterH>c+f&&(a.t=n-this.tipOuterH-this.opts.offsetY,"top"==a.arrow&&(a.arrow="bottom"));break;case "center":a.t=l-Math.floor(this.tipOuterH/2);this.opts.keepInViewport&&(a.t+this.tipOuterH>c+f?a.t=c+f-this.tipOuterH:a.t<c&&(a.t=c));break;default:a.t=n-this.tipOuterH-this.opts.offsetY,a.arrow&&"cursor"!=this.opts.alignTo||(a.arrow="bottom"),this.opts.keepInViewport&&a.t<c&&(a.t=m+this.opts.offsetY,"bottom"==a.arrow&&(a.arrow="top"))}this.pos=a}};b.fn.poshytip=function(a){if("string"==typeof a){var f=arguments,e=a;Array.prototype.shift.call(f);"destroy"==e&&(this.die?this.die("mouseenter.poshytip").die("focus.poshytip"):b(document).undelegate(this.selector,"mouseenter.poshytip").undelegate(this.selector,"focus.poshytip"));return this.each(function(){var a=b(this).data("poshytip");a&&a[e]&&a[e].apply(a,f)})}var c=b.extend({},b.fn.poshytip.defaults,a);b("#poshytip-css-"+c.className)[0]||b(['\x3cstyle id\x3d"poshytip-css-',c.className,'" type\x3d"text/css"\x3ediv.',c.className,"{visibility:hidden;position:absolute;top:0;left:0;}div.",c.className," table.tip-table, div.",c.className," table.tip-table td{margin:0;font-family:inherit;font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;vertical-align:middle;}div.",c.className," td.tip-bg-image span{display:block;font:1px/1px sans-serif;height:",c.bgImageFrameSize,"px;width:",c.bgImageFrameSize,"px;overflow:hidden;}div.",c.className," td.tip-right{background-position:100% 0;}div.",c.className," td.tip-bottom{background-position:100% 100%;}div.",c.className," td.tip-left{background-position:0 100%;}div.",c.className," div.tip-inner{background-position:-",c.bgImageFrameSize,"px -",c.bgImageFrameSize,"px;}div.",c.className," div.tip-arrow{visibility:hidden;position:absolute;overflow:hidden;font:1px/1px sans-serif;}\x3c/style\x3e"].join("")).appendTo("head");if(c.liveEvents&&"none"!=c.showOn){var d,g=b.extend({},c,{liveEvents:!1});switch(c.showOn){case "hover":d=function(){var a=b(this);a.data("poshytip")||a.poshytip(g).poshytip("mouseenter")};this.live?this.live("mouseenter.poshytip",d):b(document).delegate(this.selector,"mouseenter.poshytip",d);break;case "focus":d=function(){var a=b(this);a.data("poshytip")||a.poshytip(g).poshytip("showDelayed")},this.live?this.live("focus.poshytip",d):b(document).delegate(this.selector,"focus.poshytip",d)}return this}return this.each(function(){new b.Poshytip(this,c)})};b.fn.poshytip.defaults={content:"[title]",className:"tip-yellow",bgImageFrameSize:10,showTimeout:500,hideTimeout:100,timeOnScreen:0,showOn:"hover",liveEvents:!1,alignTo:"cursor",alignX:"right",alignY:"top",offsetX:-22,offsetY:18,keepInViewport:!0,allowTipHover:!0,followCursor:!1,fade:!0,slide:!0,slideOffset:8,showAniDuration:300,hideAniDuration:300,refreshAniDuration:200}})(jQuery);